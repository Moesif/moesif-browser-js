(function() {
var o=!0,r=null,s=!1;
(function(){var B,H,I,z;function P(a){var c=XMLHttpRequest.prototype,d=c.open,f=c.send,e=c.setRequestHeader;c.open=function(a,b){this.M=a;this.o=b;this.B={};this.N=(new Date).toISOString();return d.apply(this,arguments)};c.setRequestHeader=function(a,d){this.B[a]=d;return e.apply(this,arguments)};c.send=function(d){this.addEventListener("load",function(){var c=(new Date).toISOString();if(a){var f=this.o?this.o.toLowerCase():this.o;if(f&&0>f.indexOf("moesif.com")&&0>f.indexOf("apirequest.io")){a:if((f=this.o)&&
"string"===typeof f){var e=b.trim(f);if(0!==e.indexOf("http")){f=Q+window.location.host+"/"+e.replace(/^\./,"").replace(/^\//,"");break a}}f={uri:f,verb:this.M,time:this.N,headers:this.B};if(d)if("string"===typeof d){i.log("request post data is string");i.log(d);try{f.body=b.h(d)}catch(m){i.log("JSON decode failed"),i.log(m),f.transfer_encoding="base64",f.body=b.u(d)}}else if("object"===typeof d||Array.isArray(d)||"number"===typeof d||"boolean"===typeof d)f.body=d;var l=this.getAllResponseHeaders(),
e={};if(l)for(var l=l.split("\r\n"),C=0;C<l.length;C++){var D=l[C],p=D.indexOf(": ");0<p&&(e[D.substring(0,p)]=D.substring(p+2))}c={status:this.status,time:c,headers:e};if(this.responseText)try{c.body=b.h(this.responseText)}catch(n){c.transfer_encoding="base64",c.body=b.u(this.responseText)}a({request:f,response:c})}}});return f.apply(this,arguments)};return function(){c.open=d;c.send=f;c.setRequestHeader=e}}function J(a,c,d,f,e,j){c={uri:a&&a.host?a.host:"/",verb:"POST",time:c,headers:{}};if(a.headers){var g=
{};b.each(a.headers,function(a){g[a.name]=a.value});c.headers=g}if(f)if("string"===typeof f){i.log("request post data is string");i.log(f);try{c.body=b.h(f)}catch(h){i.log("JSON decode failed"),i.log(h),c.transfer_encoding="base64",c.body=b.u(f)}}else if("object"===typeof f||Array.isArray(f)||"number"===typeof f||"boolean"===typeof postData)c.body=f;d={status:200,time:d,headers:{}};e?d.body=e:j&&(d.body={error:j});e={request:c,response:d,metadata:{_web3:{via_web3_provider:o,path:a.path,host:a.host}}};
a.isMetaMask&&(e.metadata._web3.is_metamask=o);return e}function K(a,b){if(a.currentProvider){i.log("found my currentProvider, patching it");var d=a.currentProvider,f=d.send,e=d.sendAsync;d.send=function(a){i.log("patched send is called");i.log(a);var e=(new Date).toISOString(),h=f.apply(d,arguments);i.log("patch send result is back");i.log(h);var k=(new Date).toISOString();b&&b(J(d,e,k,a,h));return h};d.sendAsync=function(a,f){i.log("patched sendAsync is called");i.log(a);var h=(new Date).toISOString();
i.log(a);e.apply(d,[a,function(e,m){var l=(new Date).toISOString();i.log("inside patched callback");i.log(m);b&&(i.log("about to record event"),b(J(d,h,l,a,m,e)));i.log("triggering original callback");f(e,m)}])};return function(){d.send=f;d.va=e}}return r}z="1.3.0";var u;u="undefined"===typeof window?{navigator:{}}:window;var E=Array.prototype,L=Object.prototype,v=E.slice,x=L.toString,A=L.hasOwnProperty,y=u.console,w=u.navigator,q=u.document,n=w.userAgent,F=Function.prototype.bind,M=E.forEach,N=E.indexOf;
u=Array.isArray;var G={},b={trim:function(a){return a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},i={log:function(){},error:function(){},O:function(){if(!b.w(y)&&y){var a=["Moesif error:"].concat(b.q(arguments));try{y.error.apply(y,a)}catch(c){b.d(a,function(a){y.error(a)})}}}};b.bind=function(a,c){var d,f;if(F&&a.bind===F)return F.apply(a,v.call(arguments,1));if(!b.g(a))throw new TypeError;d=v.call(arguments,2);return f=function(){if(!(this instanceof f))return a.apply(c,d.concat(v.call(arguments)));
var b={};b.prototype=a.prototype;var j=new b;b.prototype=r;b=a.apply(j,d.concat(v.call(arguments)));return Object(b)===b?b:j}};b.ha=function(a){for(var c in a)"function"===typeof a[c]&&(a[c]=b.bind(a[c],a))};b.d=function(a,b,d){if(!(a===r||void 0===a))if(M&&a.forEach===M)a.forEach(b,d);else if(a.length===+a.length)for(var f=0,e=a.length;f<e&&!(f in a&&b.call(d,a[f],f,a)===G);f++);else for(f in a)if(A.call(a,f)&&b.call(d,a[f],f,a)===G)break};b.ka=function(a){a&&b.v(a)&&(a=a.replace(/&/g,"&amp;").replace(/</g,
"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"));return a};b.extend=function(a){b.d(v.call(arguments,1),function(b){for(var d in b)void 0!==b[d]&&(a[d]=b[d])});return a};b.isArray=u||function(a){return"[object Array]"===x.call(a)};b.g=function(a){try{return/^\s*\bfunction\b/.test(a)}catch(b){return s}};b.S=function(a){return!(!a||!A.call(a,"callee"))};b.q=function(a){return!a?[]:a.q?a.q():b.isArray(a)||b.S(a)?v.call(a):b.ba(a)};b.ba=function(a){var c=[];if(a===r)return c;
b.d(a,function(a){c[c.length]=a});return c};b.ma=function(a){return a};b.na=function(a,c){var d=s;if(a===r)return d;if(N&&a.indexOf===N)return-1!=a.indexOf(c);b.d(a,function(a){if(d||(d=a===c))return G});return d};b.a=function(a,b){return-1!==a.indexOf(b)};b.oa=function(a,b){a.prototype=new b;a.xa=b.prototype;return a};b.k=function(a){return a===Object(a)&&!b.isArray(a)};b.W=function(a){if(b.k(a)){for(var c in a)if(A.call(a,c))return s;return o}return s};b.w=function(a){return void 0===a};b.v=function(a){return"[object String]"==
x.call(a)};b.U=function(a){return"[object Date]"==x.call(a)};b.pa=function(a){return"[object Number]"==x.call(a)};b.V=function(a){return!!(a&&1===a.nodeType)};b.P=function(a){b.d(a,function(c,d){b.U(c)?a[d]=b.Q(c):b.k(c)&&(a[d]=b.P(c))});return a};b.timestamp=function(){Date.now=Date.now||function(){return+new Date};return Date.now()};b.Q=function(a){function b(a){return 10>a?"0"+a:a}return a.getUTCFullYear()+"-"+b(a.getUTCMonth()+1)+"-"+b(a.getUTCDate())+"T"+b(a.getUTCHours())+":"+b(a.getUTCMinutes())+
":"+b(a.getUTCSeconds())};b.L=function(a){return function(){try{return a.apply(this,arguments)}catch(b){i.O("Implementation error. Please contact support@moesif.com.")}}};b.sa=function(a,c){for(var d=0;d<c.length;d++)a.prototype[c[d]]=b.L(a.prototype[c[d]])};b.ta=function(a){for(var c in a)"function"===typeof a[c]&&(a[c]=b.L(a[c]))};b.A=function(a){var c={};b.d(a,function(a,f){b.v(a)&&0<a.length&&(c[f]=a)});return c};b.truncate=function(a,c){var d;"string"===typeof a?d=a.slice(0,c):b.isArray(a)?(d=
[],b.d(a,function(a){d.push(b.truncate(a,c))})):b.k(a)?(d={},b.d(a,function(a,e){d[e]=b.truncate(a,c)})):d=a;return d};b.l=function(){return function(a){function b(a,e){var j="",g=0,h=g="",h=0,k=j,m=[],l=e[a];l&&"object"===typeof l&&"function"===typeof l.toJSON&&(l=l.toJSON(a));switch(typeof l){case "string":return d(l);case "number":return isFinite(l)?""+l:"null";case "boolean":case "null":return""+l;case "object":if(!l)return"null";j+="    ";m=[];if("[object Array]"===x.apply(l)){h=l.length;for(g=
0;g<h;g+=1)m[g]=b(g,l)||"null";return h=0===m.length?"[]":j?"[\n"+j+m.join(",\n"+j)+"\n"+k+"]":"["+m.join(",")+"]"}for(g in l)A.call(l,g)&&(h=b(g,l))&&m.push(d(g)+(j?": ":":")+h);return h=0===m.length?"{}":j?"{"+m.join(",")+""+k+"}":"{"+m.join(",")+"}"}}function d(a){var b=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,d={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};b.lastIndex=0;return b.test(a)?
'"'+a.replace(b,function(a){var b=d[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}return b("",{"":a})}}();b.h=function(){function a(){switch(h){case "t":return e("t"),e("r"),e("u"),e("e"),o;case "f":return e("f"),e("a"),e("l"),e("s"),e("e"),s;case "n":return e("n"),e("u"),e("l"),e("l"),r}j('Unexpected "'+h+'"')}function b(){for(;h&&" ">=h;)e()}function d(){var a,b,d="",f;if('"'===h)for(;e();){if('"'===h)return e(),d;if("\\"===h)if(e(),"u"===h){for(b=
f=0;4>b;b+=1){a=parseInt(e(),16);if(!isFinite(a))break;f=16*f+a}d+=String.fromCharCode(f)}else if("string"===typeof k[h])d+=k[h];else break;else d+=h}j("Bad string")}function f(){var a;a="";"-"===h&&(a="-",e("-"));for(;"0"<=h&&"9">=h;)a+=h,e();if("."===h)for(a+=".";e()&&"0"<=h&&"9">=h;)a+=h;if("e"===h||"E"===h){a+=h;e();if("-"===h||"+"===h)a+=h,e();for(;"0"<=h&&"9">=h;)a+=h,e()}a=+a;if(isFinite(a))return a;j("Bad number")}function e(a){a&&a!==h&&j("Expected '"+a+"' instead of '"+h+"'");h=m.charAt(g);
g+=1;return h}function j(a){throw{name:"SyntaxError",message:a,ga:g,text:m};}var g,h,k={'"':'"',"\\":"\\","/":"/",b:"\u0008",f:"\u000c",n:"\n",r:"\r",t:"\t"},m,l;l=function(){b();switch(h){case "{":var g;a:{var k,m={};if("{"===h){e("{");b();if("}"===h){e("}");g=m;break a}for(;h;){k=d();b();e(":");Object.hasOwnProperty.call(m,k)&&j('Duplicate key "'+k+'"');m[k]=l();b();if("}"===h){e("}");g=m;break a}e(",");b()}}j("Bad object")}return g;case "[":a:{g=[];if("["===h){e("[");b();if("]"===h){e("]");k=g;
break a}for(;h;){g.push(l());b();if("]"===h){e("]");k=g;break a}e(",");b()}}j("Bad array")}return k;case '"':return d();case "-":return f();default:return"0"<=h&&"9">=h?f():a()}};return function(a){m=a;g=0;h=" ";a=l();b();h&&j("Syntax error");return a}}();b.u=function(a){var c,d,f,e,j=0,g=0,h="",h=[];if(!a)return a;a=b.aa(a);do c=a.charCodeAt(j++),d=a.charCodeAt(j++),f=a.charCodeAt(j++),e=c<<16|d<<8|f,c=e>>18&63,d=e>>12&63,f=e>>6&63,e&=63,h[g++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c)+
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(f)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e);while(j<a.length);h=h.join("");switch(a.length%3){case 1:h=h.slice(0,-2)+"==";break;case 2:h=h.slice(0,-1)+"="}return h};b.aa=function(a){var a=(a+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),b="",d,f,e=0,j;d=f=0;e=a.length;for(j=0;j<e;j++){var g=a.charCodeAt(j),h=r;
128>g?f++:h=127<g&&2048>g?String.fromCharCode(g>>6|192,g&63|128):String.fromCharCode(g>>12|224,g>>6&63|128,g&63|128);h!==r&&(f>d&&(b+=a.substring(d,f)),b+=h,d=f=j+1)}f>d&&(b+=a.substring(d,a.length));return b};b.da=function(){function a(){function a(b,d){var f,e=0;for(f=0;f<d.length;f++)e|=c[f]<<8*f;return b^e}var b,e,c=[],g=0;for(b=0;b<n.length;b++)e=n.charCodeAt(b),c.unshift(e&255),4<=c.length&&(g=a(g,c),c=[]);0<c.length&&(g=a(g,c));return g.toString(16)}function b(){for(var a=1*new Date,f=0;a==
1*new Date;)f++;return a.toString(16)+f.toString(16)}return function(){var d=(screen.height*screen.width).toString(16);return b()+"-"+Math.random().toString(16).replace(".","")+"-"+a()+"-"+d+"-"+b()}}();b.T=function(a){return/(google web preview|baiduspider|yandexbot|bingbot|googlebot|yahoo! slurp)/i.test(a)?o:s};b.ca=function(a,c){var d,f,e=[];b.w(c)&&(c="&");b.d(a,function(a,b){d=encodeURIComponent(a.toString());f=encodeURIComponent(b);e[e.length]=f+"="+d});return e.join(c)};b.I=function(a,b){var b=
b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),d=RegExp("[\\?&]"+b+"=([^&#]*)").exec(a);return d===r||d&&"string"!==typeof d[1]&&d[1].length?"":decodeURIComponent(d[1]).replace(/\+/g," ")};b.la=function(a,b){var d=a.match(RegExp(b+"=([^&]*)"));return d?d[1]:r};b.cookie={get:function(a){for(var a=a+"=",b=q.cookie.split(";"),d=0;d<b.length;d++){for(var f=b[d];" "==f.charAt(0);)f=f.substring(1,f.length);if(0===f.indexOf(a))return decodeURIComponent(f.substring(a.length,f.length))}return r},parse:function(a){var c;
try{c=b.h(b.cookie.get(a))||{}}catch(d){}return c},wa:function(a,b,d,f,e){var c;var j="",g="",h="";f&&(c=(j=(j=q.location.hostname.match(/[a-z0-9][a-z0-9\-]+\.[a-z\.]{2,6}$/i))?j[0]:"")?"; domain=."+j:"",j=c);d&&(g=new Date,g.setTime(g.getTime()+1E3*d),g="; expires="+g.toGMTString());e&&(h="; secure");q.cookie=a+"="+encodeURIComponent(b)+g+"; path=/"+j+h},set:function(a,b,d,f,e){var c;var j="",g="",h="";f&&(c=(j=(j=q.location.hostname.match(/[a-z0-9][a-z0-9\-]+\.[a-z\.]{2,6}$/i))?j[0]:"")?"; domain=."+
j:"",j=c);d&&(g=new Date,g.setTime(g.getTime()+864E5*d),g="; expires="+g.toGMTString());e&&(h="; secure");a=a+"="+encodeURIComponent(b)+g+"; path=/"+j+h;return q.cookie=a},remove:function(a,c){b.cookie.set(a,"",-1,c)}};b.localStorage={error:function(a){i.error("localStorage error: "+a)},get:function(a){try{return window.localStorage.getItem(a)}catch(c){b.localStorage.error(c)}return r},parse:function(a){try{return b.h(b.localStorage.get(a))||{}}catch(c){}return r},set:function(a,c){try{window.localStorage.setItem(a,
c)}catch(d){b.localStorage.error(d)}},remove:function(a){try{window.localStorage.removeItem(a)}catch(c){b.localStorage.error(c)}}};b.ja=function(){function a(a,b){return 0<=(" "+a.className+" ").replace(d," ").indexOf(" "+b+" ")}function c(d){if(!q.getElementsByTagName)return[];var d=d.split(" "),e,c,g,h,k,m,l,i=[q];for(h=0;h<d.length;h++)if(e=d[h].replace(/^\s+/,"").replace(/\s+$/,""),-1<e.indexOf("#")){c=e.split("#");e=c[0];i=q.getElementById(c[1]);if(!i||e&&i.nodeName.toLowerCase()!=e)return[];
i=[i]}else if(-1<e.indexOf(".")){c=e.split(".");e=c[0];var n=c[1];e||(e="*");c=[];for(k=g=0;k<i.length;k++){l="*"==e?i[k].all?i[k].all:i[k].getElementsByTagName("*"):i[k].getElementsByTagName(e);for(m=0;m<l.length;m++)c[g++]=l[m]}i=[];for(k=e=0;k<c.length;k++)c[k].className&&b.v(c[k].className)&&a(c[k],n)&&(i[e++]=c[k])}else if(c=e.match(/^(\w*)\[(\w+)([=~\|\^\$\*]?)=?"?([^\]"]*)"?\]$/)){e=c[1];var p=c[2],n=c[3],t=c[4];e||(e="*");c=[];for(k=g=0;k<i.length;k++){l="*"==e?i[k].all?i[k].all:i[k].getElementsByTagName("*"):
i[k].getElementsByTagName(e);for(m=0;m<l.length;m++)c[g++]=l[m]}i=[];e=0;switch(n){case "=":n=function(a){return a.getAttribute(p)==t};break;case "~":n=function(a){return a.getAttribute(p).match(RegExp("\\b"+t+"\\b"))};break;case "|":n=function(a){return a.getAttribute(p).match(RegExp("^"+t+"-?"))};break;case "^":n=function(a){return 0===a.getAttribute(p).indexOf(t)};break;case "$":n=function(a){return a.getAttribute(p).lastIndexOf(t)==a.getAttribute(p).length-t.length};break;case "*":n=function(a){return-1<
a.getAttribute(p).indexOf(t)};break;default:n=function(a){return a.getAttribute(p)}}i=[];for(k=e=0;k<c.length;k++)n(c[k])&&(i[e++]=c[k])}else{c=[];for(k=g=0;k<i.length;k++){l=i[k].getElementsByTagName(e);for(m=0;m<l.length;m++)c[g++]=l[m]}i=c}return i}var d=/[\t\r\n]/g;return function(a){return b.V(a)?[a]:b.k(a)&&!b.w(a.length)?a:c.call(this,a)}}();b.info={ia:function(){var a="",c={};b.d("utm_source utm_medium utm_campaign utm_content utm_term".split(" "),function(d){a=b.I(q.URL,d);a.length&&(c[d]=
a)});return c},Z:function(a){return 0===a.search("https?://(.*)google.([^/?]*)")?"google":0===a.search("https?://(.*)bing.com")?"bing":0===a.search("https?://(.*)yahoo.com")?"yahoo":0===a.search("https?://(.*)duckduckgo.com")?"duckduckgo":r},ua:function(a){var c=b.info.Z(a),d={};if(c!==r)d.$search_engine=c,a=b.I(a,"yahoo"!=c?"q":"p"),a.length&&(d.mp_keyword=a);return d},j:function(a,c,d){return d||b.a(a," OPR/")?b.a(a,"Mini")?"Opera Mini":"Opera":/(BlackBerry|PlayBook|BB10)/i.test(a)?"BlackBerry":
b.a(a,"IEMobile")||b.a(a,"WPDesktop")?"Internet Explorer Mobile":b.a(a,"Edge")?"Microsoft Edge":b.a(a,"FBIOS")?"Facebook Mobile":b.a(a,"Chrome")?"Chrome":b.a(a,"CriOS")?"Chrome iOS":b.a(a,"UCWEB")||b.a(a,"UCBrowser")?"UC Browser":b.a(a,"FxiOS")?"Firefox iOS":b.a(c||"","Apple")?b.a(a,"Mobile")?"Mobile Safari":"Safari":b.a(a,"Android")?"Android Mobile":b.a(a,"Konqueror")?"Konqueror":b.a(a,"Firefox")?"Firefox":b.a(a,"MSIE")||b.a(a,"Trident/")?"Internet Explorer":b.a(a,"Gecko")?"Mozilla":""},D:function(a,
c,d){c={"Internet Explorer Mobile":/rv:(\d+(\.\d+)?)/,"Microsoft Edge":/Edge\/(\d+(\.\d+)?)/,Chrome:/Chrome\/(\d+(\.\d+)?)/,"Chrome iOS":/CriOS\/(\d+(\.\d+)?)/,"UC Browser":/(UCBrowser|UCWEB)\/(\d+(\.\d+)?)/,Safari:/Version\/(\d+(\.\d+)?)/,"Mobile Safari":/Version\/(\d+(\.\d+)?)/,Opera:/(Opera|OPR)\/(\d+(\.\d+)?)/,Firefox:/Firefox\/(\d+(\.\d+)?)/,"Firefox iOS":/FxiOS\/(\d+(\.\d+)?)/,Konqueror:/Konqueror:(\d+(\.\d+)?)/,BlackBerry:/BlackBerry (\d+(\.\d+)?)/,"Android Mobile":/android\s(\d+(\.\d+)?)/,
"Internet Explorer":/(rv:|MSIE )(\d+(\.\d+)?)/,Mozilla:/rv:(\d+(\.\d+)?)/}[b.info.j(a,c,d)];if(void 0===c)return r;a=a.match(c);return!a?r:parseFloat(a[a.length-2])},z:function(){return/Windows/i.test(n)?/Phone/.test(n)||/WPDesktop/.test(n)?"Windows Phone":"Windows":/(iPhone|iPad|iPod)/.test(n)?"iOS":/Android/.test(n)?"Android":/(BlackBerry|PlayBook|BB10)/i.test(n)?"BlackBerry":/Mac/i.test(n)?"Mac OS X":/Linux/.test(n)?"Linux":""},H:function(a){return/Windows Phone/i.test(a)||/WPDesktop/.test(a)?
"Windows Phone":/iPad/.test(a)?"iPad":/iPod/.test(a)?"iPod Touch":/iPhone/.test(a)?"iPhone":/(BlackBerry|PlayBook|BB10)/i.test(a)?"BlackBerry":/Android/.test(a)?"Android":""},Y:function(a){a=a.split("/");return 3<=a.length?a[2]:""},X:function(){return b.extend(b.A({$os:b.info.z(),$browser:b.info.j(n,w.vendor,window.opera),$referrer:q.referrer,$referring_domain:b.info.Y(q.referrer),$device:b.info.H(n)}),{$current_url:window.location.href,$browser_version:b.info.D(n,w.vendor,window.opera),$screen_height:screen.height,
$screen_width:screen.width,mp_lib:"web",$lib_version:z})},ra:function(){return b.extend(b.A({$os:b.info.z(),$browser:b.info.j(n,w.vendor,window.opera)}),{$browser_version:b.info.D(n,w.vendor,window.opera)})},qa:function(a){return b.A({mp_page:a,mp_referrer:q.referrer,mp_browser:b.info.j(n,w.vendor,window.opera),mp_platform:b.info.z()})}};b.toArray=b.q;b.isObject=b.k;b.JSONEncode=b.l;b.JSONDecode=b.h;b.isBlockedUA=b.T;b.isEmptyObject=b.W;b.each=b.d;b.info=b.info;b.info.device=b.info.H;b.info.browser=
b.info.j;b.info.properties=b.info.X;var Q="https:"===document.location.protocol?"https://":"http://";B="api.moesif.net";H="/v1/events";I="/v1/users";var O="https:"===document.location.protocol?"https://":"http://";window.moesif=function(){function a(a,c,e,j){i.log("actually sending to log event "+b.l(a));var g=new XMLHttpRequest;g.open("POST",O+B+H);g.setRequestHeader("Content-Type","application/json");g.setRequestHeader("X-Moesif-Application-Id",c);g.setRequestHeader("X-Moesif-SDK","moesif-browser-js/"+
z);g.onreadystatechange=function(){4===g.readyState&&(200<=g.status&&300>=g.status?e&&i.log("sent to moesif successfully: "+a.request.uri):(i.log("failed to sent to moesif: "+a.request.uri),e&&i.error(g.statusText),j&&b.g(j)&&j(Error("can not sent to moesif"),a)))};g.send(b.l(a))}function c(a,c,e,j){var g=new XMLHttpRequest;g.open("POST",O+B+I);g.setRequestHeader("Content-Type","application/json");g.setRequestHeader("X-Moesif-Application-Id",c);g.setRequestHeader("X-Moesif-SDK","moesif-browser-js/"+
z);g.onreadystatechange=function(){4===g.readyState&&(200<=g.status&&300>=g.status?e&&i.log("update user to moesif successfully: "+a.user_id):(i.log("update user to moesif failed "+a.user_id),e&&i.error(g.statusText),j&&b.g(j)&&j(Error("can not update user to moesif"),r,a)))};g.send(b.l(a))}i.log("moesif object creator is called");return{init:function(a){if(!a)throw Error("options are required by moesif-express middleware");if(!a.applicationId)throw Error("A moesif application id is required. Please obtain it through your settings at www.moesif.com");
if(a.getTags&&!b.g(a.getTags))throw Error("getTags should be a function");if(a.getMetadata&&!b.g(a.getMetadata))throw Error("getMetadata should be a function");if(a.getApiVersion&&!b.g(a.getApiVersion))throw Error("identifyUser should be a function");if(a.maskContent&&!b.g(a.maskContent))throw Error("maskContent should be a function");if(a.skip&&!b.g(a.skip))throw Error("skip should be a function");var c={};c.R=a.getTags||function(){};c.J=a.maskContent||function(a){return a};c.getMetadata=a.getMetadata||
function(){};c.$=a.skip||function(){return s};c.G=a.debug;c.F=a.callback;c.s=a.applicationId;c.C=a.apiVersion;this.c=c;this.p=localStorage.getItem("moesif_stored_user_id");this.i=localStorage.getItem("moesif_stored_session_id");i.log("moesif initiated");return this},start:function(a){var b=this;if(this.m||this.e)return i.log("recording has already started, please call stop first."),s;i.log("moesif starting");this.m=P(function(a){b.K(a)});this.useWeb3(a);return o},useWeb3:function(a){function b(a){c.K(a)}
var c=this;if(this.e)this.e(),this.e=r;if(a)this.e=K(a,b);else if(window.web3)i.log("found global web3, will capture from it"),this.e=K(window.web3,b);return this.e?o:s},identifyUser:function(a,b){this.p=a;if(!this.c||!this.c.s)throw Error("Init needs to be called with a valid application Id before calling identify User.");b&&c({user_id:a,session_token:this.i,metadata:b},this.c.s,this.c.G,this.c.F);localStorage.setItem("moesif_stored_user_id",a)},identifySession:function(a){this.i=a;localStorage.setItem("moesif_stored_session_id",
a)},K:function(b){i.log("determining if should log: "+b.request.uri);var c=Object.assign({},b);this.p&&(c.user_id=this.p);this.i&&(c.session_token=this.i);c.tags=this.c.R(b)||"";if(this.c.C)c.request.api_version=this.c.C;this.c.J&&(c=this.c.J(c));if(this.c.getMetadata)if(c.metadata){var e=this.c.getMetadata(c);c.metadata=Object.assign(c.metadata,e)}else c.metadata=this.c.getMetadata(c);!this.c.$(b)&&!b.request.headers["X-Moesif-SDK"]?a(c,this.c.s,this.c.G,this.c.F):i.log("skipped logging for "+b.request.uri)},
fa:function(){return this.p},ea:function(){return this.i},stop:function(){if(this.m)this.m(),this.m=r;if(this.e)this.e(),this.e=r}}}()})();
})();
