(function() {
(function(){var F,G,H,I,J;function ca(a){var b=XMLHttpRequest.prototype,d=b.open,g=b.send,i=b.setRequestHeader;b.open=function(a,b){this._method=a;this._url=b;this._requestHeaders={};this._startTime=(new Date).toISOString();return d.apply(this,arguments)};b.setRequestHeader=function(a,b){this._requestHeaders[a]=b;return i.apply(this,arguments)};b.send=function(b){this.addEventListener("load",function(){var d=(new Date).toISOString();if(a){var g=this._url?this._url.toLowerCase():this._url;if(g&&0>
g.indexOf("moesif.com")&&0>g.indexOf("apirequest.io")){a:if((g=this._url)&&"string"===typeof g){var i=c.trim(g);if(0!==i.indexOf("http")){g=da+window.location.host+"/"+i.replace(/^\./,"").replace(/^\//,"");break a}}g={uri:g,verb:this._method,time:this._startTime,headers:this._requestHeaders};if(b)if("string"===typeof b){e.log("request post data is string");e.log(b);try{g.body=c.JSONDecode(b)}catch(l){e.log("JSON decode failed"),e.log(l),g.transfer_encoding="base64",g.body=c.base64Encode(b)}}else if("object"===
typeof b||Array.isArray(b)||"number"===typeof b||"boolean"===typeof b)g.body=b;var k=this.getAllResponseHeaders(),i={};if(k)for(var k=k.split("\r\n"),n=0;n<k.length;n++){var q=k[n],K=q.indexOf(": ");if(0<K){var m=q.substring(0,K);i[m]=q.substring(K+2)}}d={status:this.status,time:d,headers:i};if(this.responseText)try{d.body=c.JSONDecode(this.responseText)}catch(ma){d.transfer_encoding="base64",d.body=c.base64Encode(this.responseText)}a({request:g,response:d})}}});return g.apply(this,arguments)};return function(){b.open=
d;b.send=g;b.setRequestHeader=i}}function Q(a,b,d,g,i,f){b={uri:a&&a.host?a.host:"/",verb:"POST",time:b,headers:{}};if(a.headers){var u={};c.each(a.headers,function(a){u[a.name]=a.value});b.headers=u}if(g)if("string"===typeof g){e.log("request post data is string");e.log(g);try{b.body=c.JSONDecode(g)}catch(j){e.log("JSON decode failed"),e.log(j),b.transfer_encoding="base64",b.body=c.base64Encode(g)}}else if("object"===typeof g||Array.isArray(g)||"number"===typeof g||"boolean"===typeof postData)b.body=
g;d={status:200,time:d,headers:{}};i?d.body=i:f&&(d.body={error:f});i={request:b,response:d,metadata:{_web3:{via_web3_provider:!0,path:a.path,host:a.host}}};a.isMetaMask&&(i.metadata._web3.is_metamask=!0);return i}function R(a,b){if(a.currentProvider){e.log("found my currentProvider, patching it");var d=a.currentProvider,c=d.send,i=d.sendAsync;d.send=function(a){e.log("patched send is called");e.log(a);var i=(new Date).toISOString(),j=c.apply(d,arguments);e.log("patch send result is back");e.log(j);
var h=(new Date).toISOString();b&&b(Q(d,i,h,a,j));return j};d.sendAsync=function(a,c){e.log("patched sendAsync is called");e.log(a);var g=(new Date).toISOString();e.log(a);i.apply(d,[a,function(i,l){var k=(new Date).toISOString();e.log("inside patched callback");e.log(l);b&&(e.log("about to record event"),b(Q(d,g,k,a,l,i)));e.log("triggering original callback");c(i,l)}])};return function(){d.send=c;d.sendAsync=i}}return null}function ea(a){if(!a)return{};e.log("about to decode buffer");e.log(a);e.log(a.byteLength);
if(0>=a.byteLength)return{};try{var b=(new TextDecoder("utf-8")).decode(a);try{return{body:c.JSONDecode(b)}}catch(d){return e.error(d),{transfer_encoding:"base64",body:c.base64Encode(b)}}}catch(g){return e.error(g),e.log(a),{transfer_encoding:"base64",body:"can not be decoded"}}}function S(a){var b={};e.log("parseheaders is called");for(var a=a.entries(),d=a.next();!d.done;)e.log(d.value),b[d.value[0]]=d.value[1],d=a.next();return b}function fa(a,b,d,c,i){try{setTimeout(function(){e.log("interception is here.");
e.log(a);e.log(b);if(a&&b){e.log("inside if statement.");try{Promise.all([a.arrayBuffer(),b.arrayBuffer()]).then(function(f){e.log("processing bodies");var h=f.map(ea),f=Object.assign(h[0],{uri:a.url,verb:a.method,time:d,headers:S(a.headers)}),h=Object.assign(h[1],{status:b.status,time:c,headers:S(b.headers)});e.log(f);e.log(h);i({request:f,response:h})})}catch(f){e.log("error processing body")}}else e.log("savedRequest")},50)}catch(f){e.error("error processing saved fetch request and response, but move on anyways."),
e.log(f)}}function ga(a,b,d,c){e.log("fetch interceptor is called");var i=null;try{i=new Request(d,c)}catch(f){}var u=(new Date).toISOString(),j=null,h=null;e.log("about to perform fetch.");var h=b(d,c),l=null;return h=h.then(function(b){l=b.clone();j=(new Date).toISOString();fa(i,l,u,j,a);return b})}function ha(a,b){var d=b||window||self;if(d.fetch){e.log("found fetch method.");if(d.fetch.polyfill)return e.log("skip patching fetch since it is polyfilled"),null;var c=d.fetch;e.log("fetch is not polyfilled so instrumenting it");
d.fetch=function(b){return function(d,c){return ga(a,b,d,c)}}(d.fetch);return function(){d.fetch=c}}e.log("there is no fetch found")}function ia(a,b){var d=a?"?"+a.split(".").slice(-1)[0].replace(/\|/g,"&"):"";e.log("cookie");e.log(d);var g=c.getQueryParamByName(F,b)||c.getQueryParamByName("utmcsr",d),i=c.getQueryParamByName(G,b)||c.getQueryParamByName("utmcmd",d),f=c.getQueryParamByName(H,b)||c.getQueryParamByName("utmccn",d),u=c.getQueryParamByName(I,b)||c.getQueryParamByName("utmctr",d),d=c.getQueryParamByName(J,
b)||c.getQueryParamByName("utmcct",d),j={},h=function(a,b){c.isEmptyString(b)||(j[a]=b)};h(F,g);h(G,i);h(H,f);h(I,u);h(J,d);return j}function ja(a){try{var b={};if(!a.disableUtm)var d=void 0,g=void 0,d=location&&location.search,g=c.cookie.get("__utmz"),b=ia(g,d)||{};if(!a.disableReferer){var i;var f=document&&document.referrer,u;if(c.isEmptyString(f))u=void 0;else{var j;if(c.isEmptyString(f))j=null;else{var h=f.split("/");j=3<=h.length?h[2]:null}u={referrer:f,referring_domain:j}}i=u;if(i)b.referrer=
i.referrer,b.referring_domain=i.referring_domain}if(!a.disableRGclid){var l,k=c.getQueryParamByName("gclid",location&&location.search);(l=c.isEmptyString(k)?void 0:k)&&(b.gclid=l)}return b}catch(n){e.error(n)}}function T(a){try{return a.request.headers["X-Moesif-SDK"]}catch(b){return!1}}function ka(a){if(!a)throw Error("options are required by moesif-express middleware");if(!a.applicationId)throw Error("A moesif application id is required. Please obtain it through your settings at www.moesif.com");
if(a.getTags&&!c.isFunction(a.getTags))throw Error("getTags should be a function");if(a.getMetadata&&!c.isFunction(a.getMetadata))throw Error("getMetadata should be a function");if(a.getApiVersion&&!c.isFunction(a.getApiVersion))throw Error("identifyUser should be a function");if(a.maskContent&&!c.isFunction(a.maskContent))throw Error("maskContent should be a function");if(a.skip&&!c.isFunction(a.skip))throw Error("skip should be a function");}var s;s="undefined"===typeof window?{navigator:{}}:window;
var C=Array.prototype,U=Object.prototype,x=C.slice,A=U.toString,D=U.hasOwnProperty,o=s.console,y=s.navigator,p=s.document,m=y.userAgent,L=Function.prototype.bind,V=C.forEach,W=C.indexOf,X=C.map;s=Array.isArray;var M={},c={trim:function(a){return a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},e={log:function(){if(!c.isUndefined(o)&&o)try{o.log.apply(o,arguments)}catch(a){c.each(arguments,function(a){o.log(a)})}},error:function(){if(!c.isUndefined(o)&&o){var a=["Moesif error:"].concat(c.toArray(arguments));
try{o.error.apply(o,a)}catch(b){c.each(a,function(a){o.error(a)})}}},critical:function(){if(!c.isUndefined(o)&&o){var a=["Moesif error:"].concat(c.toArray(arguments));try{o.error.apply(o,a)}catch(b){c.each(a,function(a){o.error(a)})}}}};c.bind=function(a,b){var d,g;if(L&&a.bind===L)return L.apply(a,x.call(arguments,1));if(!c.isFunction(a))throw new TypeError;d=x.call(arguments,2);return g=function(){if(!(this instanceof g))return a.apply(b,d.concat(x.call(arguments)));var c={};c.prototype=a.prototype;
var f=new c;c.prototype=null;c=a.apply(f,d.concat(x.call(arguments)));return Object(c)===c?c:f}};c.bind_instance_methods=function(a){for(var b in a)"function"===typeof a[b]&&(a[b]=c.bind(a[b],a))};c.isEmptyString=function(a){return!a||0===a.length};c.each=function(a,b,d){if(!(null===a||void 0===a))if(V&&a.forEach===V)a.forEach(b,d);else if(a.length===+a.length)for(var c=0,i=a.length;c<i&&!(c in a&&b.call(d,a[c],c,a)===M);c++);else for(c in a)if(D.call(a,c)&&b.call(d,a[c],c,a)===M)break};c.escapeHTML=
function(a){a&&c.isString(a)&&(a=a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"));return a};c.extend=function(a){c.each(x.call(arguments,1),function(b){for(var d in b)void 0!==b[d]&&(a[d]=b[d])});return a};c.isArray=s||function(a){return"[object Array]"===A.call(a)};c.isFunction=function(a){try{return/^\s*\bfunction\b/.test(a)}catch(b){return!1}};c.isArguments=function(a){return!(!a||!D.call(a,"callee"))};c.toArray=function(a){return!a?
[]:a.toArray?a.toArray():c.isArray(a)||c.isArguments(a)?x.call(a):c.values(a)};c.map=function(a,b){if(X&&a.map===X)return a.map(b);var d=[];c.each(a,function(a){d.push(b(a))});return d};c.values=function(a){var b=[];if(null===a)return b;c.each(a,function(a){b[b.length]=a});return b};c.identity=function(a){return a};c.include=function(a,b){var d=!1;if(null===a)return d;if(W&&a.indexOf===W)return-1!=a.indexOf(b);c.each(a,function(a){if(d||(d=a===b))return M});return d};c.includes=function(a,b){return-1!==
a.indexOf(b)};c.inherit=function(a,b){a.prototype=new b;a.prototype.constructor=a;a.superclass=b.prototype;return a};c.isObject=function(a){return a===Object(a)&&!c.isArray(a)};c.isEmptyObject=function(a){if(c.isObject(a)){for(var b in a)if(D.call(a,b))return!1;return!0}return!1};c.isUndefined=function(a){return void 0===a};c.isString=function(a){return"[object String]"==A.call(a)};c.isDate=function(a){return"[object Date]"==A.call(a)};c.isNumber=function(a){return"[object Number]"==A.call(a)};c.isElement=
function(a){return!!(a&&1===a.nodeType)};c.encodeDates=function(a){c.each(a,function(b,d){c.isDate(b)?a[d]=c.formatDate(b):c.isObject(b)&&(a[d]=c.encodeDates(b))});return a};c.timestamp=function(){Date.now=Date.now||function(){return+new Date};return Date.now()};c.formatDate=function(a){function b(a){return 10>a?"0"+a:a}return a.getUTCFullYear()+"-"+b(a.getUTCMonth()+1)+"-"+b(a.getUTCDate())+"T"+b(a.getUTCHours())+":"+b(a.getUTCMinutes())+":"+b(a.getUTCSeconds())};c.safewrap=function(a){return function(){try{return a.apply(this,
arguments)}catch(b){e.critical("Implementation error. Please contact support@moesif.com.")}}};c.safewrap_class=function(a,b){for(var d=0;d<b.length;d++)a.prototype[b[d]]=c.safewrap(a.prototype[b[d]])};c.safewrap_instance_methods=function(a){for(var b in a)"function"===typeof a[b]&&(a[b]=c.safewrap(a[b]))};c.strip_empty_properties=function(a){var b={};c.each(a,function(a,g){c.isString(a)&&0<a.length&&(b[g]=a)});return b};c.truncate=function(a,b){var d;"string"===typeof a?d=a.slice(0,b):c.isArray(a)?
(d=[],c.each(a,function(a){d.push(c.truncate(a,b))})):c.isObject(a)?(d={},c.each(a,function(a,i){d[i]=c.truncate(a,b)})):d=a;return d};c.JSONEncode=function(){return function(a){var b=function(a){var b=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};b.lastIndex=0;return b.test(a)?'"'+a.replace(b,function(a){var b=c[a];return"string"===
typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'},c=function(a,i){var f="",e=0,j=e="",j=0,h=f,l=[],k=i[a];k&&"object"===typeof k&&"function"===typeof k.toJSON&&(k=k.toJSON(a));switch(typeof k){case "string":return b(k);case "number":return isFinite(k)?""+k:"null";case "boolean":case "null":return""+k;case "object":if(!k)return"null";f+="    ";l=[];if("[object Array]"===A.apply(k)){j=k.length;for(e=0;e<j;e+=1)l[e]=c(e,k)||"null";return j=0===l.length?"[]":f?"[\n"+f+
l.join(",\n"+f)+"\n"+h+"]":"["+l.join(",")+"]"}for(e in k)D.call(k,e)&&(j=c(e,k))&&l.push(b(e)+(f?": ":":")+j);return j=0===l.length?"{}":f?"{"+l.join(",")+""+h+"}":"{"+l.join(",")+"}"}};return c("",{"":a})}}();c.JSONDecode=function(){var a,b,c={'"':'"',"\\":"\\","/":"/",b:"\u0008",f:"\u000c",n:"\n",r:"\r",t:"\t"},g,i=function(b){throw{name:"SyntaxError",message:b,at:a,text:g};},f=function(c){c&&c!==b&&i("Expected '"+c+"' instead of '"+b+"'");b=g.charAt(a);a+=1;return b},e=function(){var a;a="";"-"===
b&&(a="-",f("-"));for(;"0"<=b&&"9">=b;)a+=b,f();if("."===b)for(a+=".";f()&&"0"<=b&&"9">=b;)a+=b;if("e"===b||"E"===b){a+=b;f();if("-"===b||"+"===b)a+=b,f();for(;"0"<=b&&"9">=b;)a+=b,f()}a=+a;if(isFinite(a))return a;i("Bad number")},j=function(){var a,g,e="",h;if('"'===b)for(;f();){if('"'===b)return f(),e;if("\\"===b)if(f(),"u"===b){for(g=h=0;4>g;g+=1){a=parseInt(f(),16);if(!isFinite(a))break;h=16*h+a}e+=String.fromCharCode(h)}else if("string"===typeof c[b])e+=c[b];else break;else e+=b}i("Bad string")},
h=function(){for(;b&&" ">=b;)f()},l=function(){switch(b){case "t":return f("t"),f("r"),f("u"),f("e"),!0;case "f":return f("f"),f("a"),f("l"),f("s"),f("e"),!1;case "n":return f("n"),f("u"),f("l"),f("l"),null}i('Unexpected "'+b+'"')},k;k=function(){h();switch(b){case "{":var a;a:{var c,d={};if("{"===b){f("{");h();if("}"===b){f("}");a=d;break a}for(;b;){c=j();h();f(":");Object.hasOwnProperty.call(d,c)&&i('Duplicate key "'+c+'"');d[c]=k();h();if("}"===b){f("}");a=d;break a}f(",");h()}}i("Bad object")}return a;
case "[":a:{a=[];if("["===b){f("[");h();if("]"===b){f("]");c=a;break a}for(;b;){a.push(k());h();if("]"===b){f("]");c=a;break a}f(",");h()}}i("Bad array")}return c;case '"':return j();case "-":return e();default:return"0"<=b&&"9">=b?e():l()}};return function(c){g=c;a=0;b=" ";c=k();h();b&&i("Syntax error");return c}}();c.base64Encode=function(a){var b,d,g,i,f=0,e=0,j="",j=[];if(!a)return a;a=c.utf8Encode(a);do b=a.charCodeAt(f++),d=a.charCodeAt(f++),g=a.charCodeAt(f++),i=b<<16|d<<8|g,b=i>>18&63,d=i>>
12&63,g=i>>6&63,i&=63,j[e++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(g)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(i);while(f<a.length);j=j.join("");switch(a.length%3){case 1:j=j.slice(0,-2)+"==";break;case 2:j=j.slice(0,-1)+"="}return j};c.utf8Encode=function(a){var a=(a+"").replace(/\r\n/g,
"\n").replace(/\r/g,"\n"),b="",c,g,i=0,f;c=g=0;i=a.length;for(f=0;f<i;f++){var e=a.charCodeAt(f),j=null;128>e?g++:j=127<e&&2048>e?String.fromCharCode(e>>6|192,e&63|128):String.fromCharCode(e>>12|224,e>>6&63|128,e&63|128);null!==j&&(g>c&&(b+=a.substring(c,g)),b+=j,c=g=f+1)}g>c&&(b+=a.substring(c,a.length));return b};c.UUID=function(){var a=function(){for(var a=1*new Date,b=0;a==1*new Date;)b++;return a.toString(16)+b.toString(16)},b=function(){function a(b,c){var d,g=0;for(d=0;d<c.length;d++)g|=f[d]<<
8*d;return b^g}var b,c,f=[],e=0;for(b=0;b<m.length;b++)c=m.charCodeAt(b),f.unshift(c&255),4<=f.length&&(e=a(e,f),f=[]);0<f.length&&(e=a(e,f));return e.toString(16)};return function(){var c=(screen.height*screen.width).toString(16);return a()+"-"+Math.random().toString(16).replace(".","")+"-"+b()+"-"+c+"-"+a()}}();c.isBlockedUA=function(a){return/(google web preview|baiduspider|yandexbot|bingbot|googlebot|yahoo! slurp)/i.test(a)?!0:!1};c.HTTPBuildQuery=function(a,b){var d,g,i=[];c.isUndefined(b)&&
(b="&");c.each(a,function(a,b){d=encodeURIComponent(a.toString());g=encodeURIComponent(b);i[i.length]=g+"="+d});return i.join(b)};c.getQueryParamByName=function(a,b){var a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),c=RegExp("[\\?&]"+a+"=([^&#]*)").exec(b);return null===c?void 0:decodeURIComponent(c[1].replace(/\+/g," "))};c.getQueryParam=function(a,b){var b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),c=RegExp("[\\?&]"+b+"=([^&#]*)").exec(a);return null===c||c&&"string"!==typeof c[1]&&c[1].length?
"":decodeURIComponent(c[1]).replace(/\+/g," ")};c.getHashParam=function(a,b){var c=a.match(RegExp(b+"=([^&]*)"));return c?c[1]:null};c.cookie={get:function(a){for(var a=a+"=",b=p.cookie.split(";"),c=0;c<b.length;c++){for(var g=b[c];" "==g.charAt(0);)g=g.substring(1,g.length);if(0===g.indexOf(a))return decodeURIComponent(g.substring(a.length,g.length))}return null},parse:function(a){var b;try{b=c.JSONDecode(c.cookie.get(a))||{}}catch(d){}return b},set_seconds:function(a,b,c,g,i){var d;var f="",e="",
j="";g&&(d=(f=(f=p.location.hostname.match(/[a-z0-9][a-z0-9\-]+\.[a-z\.]{2,6}$/i))?f[0]:"")?"; domain=."+f:"",f=d);c&&(e=new Date,e.setTime(e.getTime()+1E3*c),e="; expires="+e.toGMTString());i&&(j="; secure");p.cookie=a+"="+encodeURIComponent(b)+e+"; path=/"+f+j},set:function(a,b,c,g,i){var d;var f="",e="",j="";g&&(d=(f=(f=p.location.hostname.match(/[a-z0-9][a-z0-9\-]+\.[a-z\.]{2,6}$/i))?f[0]:"")?"; domain=."+f:"",f=d);c&&(e=new Date,e.setTime(e.getTime()+864E5*c),e="; expires="+e.toGMTString());
i&&(j="; secure");a=a+"="+encodeURIComponent(b)+e+"; path=/"+f+j;return p.cookie=a},remove:function(a,b){c.cookie.set(a,"",-1,b)}};var N=null,O=function(a,b){if(null!==N&&!b)return N;var c=!0;try{var a=a||window.localStorage,g="__mplss_"+Y(8);a.setItem(g,"xyz");"xyz"!==a.getItem(g)&&(c=!1);a.removeItem(g)}catch(i){c=!1}return N=c};c.localStorage={error:function(a){e.error("localStorage error: "+a)},get:function(a){try{return window.localStorage.getItem(a)}catch(b){c.localStorage.error(b)}return null},
parse:function(a){try{return c.JSONDecode(c.localStorage.get(a))||{}}catch(b){}return null},set:function(a,b){try{window.localStorage.setItem(a,b)}catch(d){c.localStorage.error(d)}},remove:function(a){try{window.localStorage.removeItem(a)}catch(b){c.localStorage.error(b)}}};c.dom_query=function(){function a(a,b){var c;return 0<=(" "+a.className+" ").replace(d," ").indexOf(" "+b+" ")}function b(b){if(!p.getElementsByTagName)return[];var b=b.split(" "),d,f,e,j,h,l,k,n=[p];for(j=0;j<b.length;j++)if(d=
b[j].replace(/^\s+/,"").replace(/\s+$/,""),-1<d.indexOf("#")){f=d.split("#");d=f[0];n=p.getElementById(f[1]);if(!n||d&&n.nodeName.toLowerCase()!=d)return[];n=[n]}else if(-1<d.indexOf(".")){f=d.split(".");d=f[0];var q=f[1];d||(d="*");f=[];for(h=e=0;h<n.length;h++){k="*"==d?n[h].all?n[h].all:n[h].getElementsByTagName("*"):n[h].getElementsByTagName(d);for(l=0;l<k.length;l++)f[e++]=k[l]}n=[];for(h=d=0;h<f.length;h++)f[h].className&&c.isString(f[h].className)&&a(f[h],q)&&(n[d++]=f[h])}else if(f=d.match(/^(\w*)\[(\w+)([=~\|\^\$\*]?)=?"?([^\]"]*)"?\]$/)){d=
f[1];var m=f[2],q=f[3],o=f[4];d||(d="*");f=[];for(h=e=0;h<n.length;h++){k="*"==d?n[h].all?n[h].all:n[h].getElementsByTagName("*"):n[h].getElementsByTagName(d);for(l=0;l<k.length;l++)f[e++]=k[l]}n=[];d=0;switch(q){case "=":q=function(a){return a.getAttribute(m)==o};break;case "~":q=function(a){return a.getAttribute(m).match(RegExp("\\b"+o+"\\b"))};break;case "|":q=function(a){return a.getAttribute(m).match(RegExp("^"+o+"-?"))};break;case "^":q=function(a){return 0===a.getAttribute(m).indexOf(o)};break;
case "$":q=function(a){return a.getAttribute(m).lastIndexOf(o)==a.getAttribute(m).length-o.length};break;case "*":q=function(a){return-1<a.getAttribute(m).indexOf(o)};break;default:q=function(a){return a.getAttribute(m)}}n=[];for(h=d=0;h<f.length;h++)q(f[h])&&(n[d++]=f[h])}else{f=[];for(h=e=0;h<n.length;h++){k=n[h].getElementsByTagName(d);for(l=0;l<k.length;l++)f[e++]=k[l]}n=f}return n}var d=/[\t\r\n]/g;return function(a){return c.isElement(a)?[a]:c.isObject(a)&&!c.isUndefined(a.length)?a:b.call(this,
a)}}();c.info={campaignParams:function(){var a="utm_source utm_medium utm_campaign utm_content utm_term".split(" "),b="",d={};c.each(a,function(a){b=c.getQueryParam(p.URL,a);b.length&&(d[a]=b)});return d},searchEngine:function(a){return 0===a.search("https?://(.*)google.([^/?]*)")?"google":0===a.search("https?://(.*)bing.com")?"bing":0===a.search("https?://(.*)yahoo.com")?"yahoo":0===a.search("https?://(.*)duckduckgo.com")?"duckduckgo":null},searchInfo:function(a){var b=c.info.searchEngine(a),d;d=
{};if(null!==b)d.$search_engine=b,a=c.getQueryParam(a,"yahoo"!=b?"q":"p"),a.length&&(d.mp_keyword=a);return d},browser:function(a,b,d){b=b||"";return d||c.includes(a," OPR/")?c.includes(a,"Mini")?"Opera Mini":"Opera":/(BlackBerry|PlayBook|BB10)/i.test(a)?"BlackBerry":c.includes(a,"IEMobile")||c.includes(a,"WPDesktop")?"Internet Explorer Mobile":c.includes(a,"Edge")?"Microsoft Edge":c.includes(a,"FBIOS")?"Facebook Mobile":c.includes(a,"Chrome")?"Chrome":c.includes(a,"CriOS")?"Chrome iOS":c.includes(a,
"UCWEB")||c.includes(a,"UCBrowser")?"UC Browser":c.includes(a,"FxiOS")?"Firefox iOS":c.includes(b,"Apple")?c.includes(a,"Mobile")?"Mobile Safari":"Safari":c.includes(a,"Android")?"Android Mobile":c.includes(a,"Konqueror")?"Konqueror":c.includes(a,"Firefox")?"Firefox":c.includes(a,"MSIE")||c.includes(a,"Trident/")?"Internet Explorer":c.includes(a,"Gecko")?"Mozilla":""},browserVersion:function(a,b,d){b={"Internet Explorer Mobile":/rv:(\d+(\.\d+)?)/,"Microsoft Edge":/Edge\/(\d+(\.\d+)?)/,Chrome:/Chrome\/(\d+(\.\d+)?)/,
"Chrome iOS":/CriOS\/(\d+(\.\d+)?)/,"UC Browser":/(UCBrowser|UCWEB)\/(\d+(\.\d+)?)/,Safari:/Version\/(\d+(\.\d+)?)/,"Mobile Safari":/Version\/(\d+(\.\d+)?)/,Opera:/(Opera|OPR)\/(\d+(\.\d+)?)/,Firefox:/Firefox\/(\d+(\.\d+)?)/,"Firefox iOS":/FxiOS\/(\d+(\.\d+)?)/,Konqueror:/Konqueror:(\d+(\.\d+)?)/,BlackBerry:/BlackBerry (\d+(\.\d+)?)/,"Android Mobile":/android\s(\d+(\.\d+)?)/,"Internet Explorer":/(rv:|MSIE )(\d+(\.\d+)?)/,Mozilla:/rv:(\d+(\.\d+)?)/}[c.info.browser(a,b,d)];if(void 0===b)return null;
a=a.match(b);return!a?null:parseFloat(a[a.length-2])},os:function(){return/Windows/i.test(m)?/Phone/.test(m)||/WPDesktop/.test(m)?"Windows Phone":"Windows":/(iPhone|iPad|iPod)/.test(m)?"iOS":/Android/.test(m)?"Android":/(BlackBerry|PlayBook|BB10)/i.test(m)?"BlackBerry":/Mac/i.test(m)?"Mac OS X":/Linux/.test(m)?"Linux":""},device:function(a){return/Windows Phone/i.test(a)||/WPDesktop/.test(a)?"Windows Phone":/iPad/.test(a)?"iPad":/iPod/.test(a)?"iPod Touch":/iPhone/.test(a)?"iPhone":/(BlackBerry|PlayBook|BB10)/i.test(a)?
"BlackBerry":/Android/.test(a)?"Android":""},referringDomain:function(a){a=a.split("/");return 3<=a.length?a[2]:""},properties:function(){return c.extend(c.strip_empty_properties({$os:c.info.os(),$browser:c.info.browser(m,y.vendor,window.opera),$referrer:p.referrer,$referring_domain:c.info.referringDomain(p.referrer),$device:c.info.device(m)}),{$current_url:window.location.href,$browser_version:c.info.browserVersion(m,y.vendor,window.opera),$screen_height:screen.height,$screen_width:screen.width,
mp_lib:"web",$lib_version:"1.5.9"})},people_properties:function(){return c.extend(c.strip_empty_properties({$os:c.info.os(),$browser:c.info.browser(m,y.vendor,window.opera)}),{$browser_version:c.info.browserVersion(m,y.vendor,window.opera)})},pageviewInfo:function(a){return c.strip_empty_properties({mp_page:a,mp_referrer:p.referrer,mp_browser:c.info.browser(m,y.vendor,window.opera),mp_platform:c.info.os()})}};var Y=function(a){var b=Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,
10);return a?b.substring(0,a):b},P=function(a,b){return function(){arguments[0]="["+b+"] "+arguments[0];return a.apply(e,arguments)}};s=function(a){return{log:P(e.log,a),error:P(e.error,a),critical:P(e.critical,a)}};var B=null,E=null;if("undefined"!==typeof JSON)B=JSON.stringify,E=JSON.parse;B=B||c.JSONEncode;E=E||c.JSONDecode;c.toArray=c.toArray;c.isObject=c.isObject;c.JSONEncode=c.JSONEncode;c.JSONDecode=c.JSONDecode;c.isBlockedUA=c.isBlockedUA;c.isEmptyObject=c.isEmptyObject;c.isEmptyString=c.isEmptyString;
c.each=c.each;c.info=c.info;c.info.device=c.info.device;c.info.browser=c.info.browser;c.info.properties=c.info.properties;var da="http:"===(document&&document.location.protocol)?"http://":"https://";F="utm_source";G="utm_medium";H="utm_campaign";I="utm_term";J="utm_content";var la=s("lock"),Z=function(a,b){b=b||{};this.storageKey=a;this.storage=b.storage||window.localStorage;this.pollIntervalMS=b.pollIntervalMS||100;this.timeoutMS=b.timeoutMS||2E3};Z.prototype.withLock=function(a,b,c){!c&&"function"!==
typeof b&&(c=b,b=null);var g=c||(new Date).getTime()+"|"+Math.random(),e=(new Date).getTime(),f=this.storageKey,m=this.pollIntervalMS,j=this.timeoutMS,h=this.storage,l=f+":X",k=f+":Y",n=f+":Z",o=function(a){(new Date).getTime()-e>j?(la.error("Timeout waiting for mutex on "+f+"; clearing lock. ["+g+"]"),h.removeItem(n),h.removeItem(k),r()):setTimeout(function(){try{a()}catch(c){b&&b(c)}},m*(Math.random()+0.1))},p=function(a,b){a()?b():o(function(){p(a,b)})},s=function(){var a=h.getItem(k);if(a&&a!==
g)return!1;h.setItem(k,g);if(h.getItem(k)===g)return!0;if(!O(h,!0))throw Error("localStorage support dropped while acquiring lock");return!1},r=function(){h.setItem(l,g);p(s,function(){h.getItem(l)===g?t():o(function(){h.getItem(k)!==g?r():p(function(){return!h.getItem(n)},t)})})},t=function(){h.setItem(n,"1");try{a()}finally{h.removeItem(n),h.getItem(k)===g&&h.removeItem(k),h.getItem(l)===g&&h.removeItem(l)}};try{if(O(h,!0))r();else throw Error("localStorage support check failed");}catch(v){b&&b(v)}};
var v=s("batch"),w=function(a,b){b=b||{};this.storageKey=a;this.storage=b.storage||window.localStorage;this.lock=new Z(a,{storage:this.storage});this.pid=b.pid||null;this.memQueue=[]};w.prototype.enqueue=function(a,b,d){var g={id:Y(),flushAfter:(new Date).getTime()+2*b,payload:a};this.lock.withLock(c.bind(function(){var b;try{var c=this.readFromStorage();c.push(g);(b=this.saveToStorage(c))&&this.memQueue.push(g)}catch(e){v.error("Error enqueueing item",a),b=!1}d&&d(b)},this),function(a){v.error("Error acquiring storage lock",
a);d&&d(!1)},this.pid)};w.prototype.fillBatch=function(a){var b=this.memQueue.slice(0,a);if(b.length<a){var d=this.readFromStorage();if(d.length){var e={};c.each(b,function(a){e[a.id]=!0});for(var i=0;i<d.length;i++){var f=d[i];if((new Date).getTime()>f.flushAfter&&!e[f.id]&&(b.push(f),b.length>=a))break}}}return b};var $=function(a,b){var d=[];c.each(a,function(a){a.id&&!b[a.id]&&d.push(a)});return d};w.prototype.removeItemsByID=function(a,b){var d={};c.each(a,function(a){d[a]=!0});this.memQueue=
$(this.memQueue,d);this.lock.withLock(c.bind(function(){var c;try{var e=this.readFromStorage(),e=$(e,d);c=this.saveToStorage(e)}catch(f){v.error("Error removing items",a),c=!1}b&&b(c)},this),function(a){v.error("Error acquiring storage lock",a);b&&b(!1)},this.pid)};w.prototype.readFromStorage=function(){var a;try{if(a=this.storage.getItem(this.storageKey))a=E(a),c.isArray(a)||(v.error("Invalid storage entry:",a),a=null)}catch(b){v.error("Error retrieving queue",b),a=null}return a||[]};w.prototype.saveToStorage=
function(a){try{return this.storage.setItem(this.storageKey,B(a)),!0}catch(b){return v.error("Error saving queue",b),!1}};w.prototype.clear=function(){this.memQueue=[];this.storage.removeItem(this.storageKey)};var t=s("batch"),r=function(a,b,c){this.queue=new w(a,{storage:c.storage});this.endpoint=b;this.libConfig=c.libConfig;this.sendRequest=c.sendRequestFunc;this.batchSize=this.libConfig.batch_size;this.flushInterval=this.libConfig.batch_flush_interval_ms;this.stopped=!1};r.prototype.enqueue=function(a,
b){this.queue.enqueue(a,this.flushInterval,b)};r.prototype.start=function(){this.stopped=!1;this.flush()};r.prototype.stop=function(){this.stopped=!0;if(this.timeoutID)clearTimeout(this.timeoutID),this.timeoutID=null};r.prototype.clear=function(){this.queue.clear()};r.prototype.resetBatchSize=function(){this.batchSize=this.libConfig.batch_size};r.prototype.resetFlush=function(){this.scheduleFlush(this.libConfig.batch_flush_interval_ms)};r.prototype.scheduleFlush=function(a){this.flushInterval=a;if(!this.stopped)this.timeoutID=
setTimeout(c.bind(this.flush,this),this.flushInterval)};r.prototype.flush=function(a){try{if(this.requestInProgress)t.log("Flush: Request already in progress");else{var a=a||{},b=this.batchSize,d=this.queue.fillBatch(b);if(1>d.length)this.resetFlush();else{this.requestInProgress=!0;var e=this.libConfig.batch_request_timeout_ms,i=(new Date).getTime(),f=c.map(d,function(a){return a.payload}),m=c.bind(function(a){this.requestInProgress=!1;try{var f=!1;if(c.isObject(a)&&"timeout"===a.error&&(new Date).getTime()-
i>=e)t.error("Network timeout; retrying"),this.flush();else if(c.isObject(a)&&a.xhr_req&&(500<=a.xhr_req.status||0>=a.xhr_req.status)){var h=2*this.flushInterval,j=a.xhr_req.responseHeaders;if(j){var m=j["Retry-After"];m&&(h=1E3*parseInt(m,10)||h)}h=Math.min(6E5,h);t.error("Error; retry in "+h+" ms");this.scheduleFlush(h)}else if(c.isObject(a)&&a.xhr_req&&413===a.xhr_req.status)if(1<d.length){var o=Math.max(1,Math.floor(b/2));this.batchSize=Math.min(this.batchSize,o,d.length-1);t.error("413 response; reducing batch size to "+
this.batchSize);this.resetFlush()}else t.error("Single-event request too large; dropping",d),this.resetBatchSize(),f=!0;else f=!0;f&&this.queue.removeItemsByID(c.map(d,function(a){return a.id}),c.bind(this.flush,this))}catch(p){t.error("Error handling API response",p),this.resetFlush()}},this),j={method:"POST",verbose:!0,ignore_json_errors:!0,timeout_ms:e};if(a.sendBeacon)j.transport="sendBeacon";t.log("MIXPANEL REQUEST:",this.endpoint,f);this.sendRequest(this.endpoint,f,j,m)}}}catch(h){t.error("Error flushing request queue",
h),this.resetFlush()}};var aa=window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest;!aa&&-1===m.indexOf("MSIE")&&m.indexOf("Mozilla");var ba=null;navigator.sendBeacon&&(ba=function(){return navigator.sendBeacon.apply(navigator,arguments)});var z="http:"===(document&&document.location.protocol)?"http://":"https://";window.moesif=function(){e.log("moesif object creator is called");return{init:function(a){window||e.critical("Warning, this library need to be initiated on the client side");ka(a);
var b={};b.getTags=a.getTags||function(){};b.maskContent=a.maskContent||function(a){return a};b.getMetadata=a.getMetadata||function(){};b.skip=a.skip||function(){return!1};b.debug=a.debug;b.callback=a.callback;b.applicationId=a.applicationId;b.apiVersion=a.apiVersion;b.disableFetch=a.disableFetch;b.disableReferrer=a.disableReferrer;b.disableGclid=a.disableGclid;b.disableUtm=a.disableUtm;b.batch=a.batch||!1;b.batch_size=a.batch_size||50;b.batch_flush_interval_ms=a.batch_flush_interval_ms||5E3;b.batch_request_timeout_ms=
a.batch_request_timeout_ms||9E4;this.requestBatchers={};this._options=b;this._userId=localStorage.getItem("moesif_stored_user_id");this._session=localStorage.getItem("moesif_stored_session_id");this._companyId=localStorage.getItem("moesif_stored_company_id");this._campaign=ja(b);if(b.batch)!O||!aa?(b.batch=!1,e.log("Turning off batch processing because it needs XHR and localStorage")):(this.initBatching(),ba&&window.addEventListener&&window.addEventListener("unload",c.bind(function(){this.requestBatchers.events.flush({sendBeacon:!0})},
this)));e.log("moesif initiated");return this},_executeRequest:function(a,b,d,g){d=d&&d.applicationId||this._options.applicationId;try{var i=new XMLHttpRequest;i.open("POST",a);i.setRequestHeader("Content-Type","application/json");i.setRequestHeader("X-Moesif-Application-Id",d);i.setRequestHeader("X-Moesif-SDK","moesif-browser-js/1.5.9");i.onreadystatechange=function(){4===i.readyState&&(200<=i.status&&300>=i.status?e.log("sent to moesif successfully: "+b):(e.log("failed to sent to moesif: "+b),e.error(i.statusText),
g&&c.isFunction(g)&&g(Error("can not sent to moesif"),b)))};i.send(B(b))}catch(f){e.error("failed to send event to moesif"+event.request.uri),e.error(f)}},initBatching:function(){var a=this._options.applicationId;if(!this.requestBatchers.events){var b={libConfig:this._options,sendRequestFunc:c.bind(function(a,b,c,f){this._executeRequest(a,b,c,f)},this)};this.requestBatchers={events:new r("__mf_"+a+"_ev",z+"api.moesif.net/v1/events/batch",b),actions:new r("__mf_"+a+"_ac",z+"api.moesif.net/v1/actions/batch",
b)}}c.each(this.requestBatchers,function(a){a.start()})},_sendOrBatch:function(a,b,c,e,i){var f=!0;this._options.batch&&e?e.enqueue(a):f=this._executeRequest(c,a,{applicationId:b},i);return f},start:function(a){function b(a){c.recordEvent(a)}var c=this;if(this._stopRecording||this._stopWeb3Recording)return e.log("recording has already started, please call stop first."),!1;e.log("moesif starting");this._stopRecording=ca(b);if(!this._options.disableFetch)e.log("also instrumenting fetch API"),this._stopFetchRecording=
ha(b);this.useWeb3(a);return!0},useWeb3:function(a){function b(a){c.recordEvent(a)}var c=this;if(this._stopWeb3Recording)this._stopWeb3Recording(),this._stopWeb3Recording=null;if(a)this._stopWeb3Recording=R(a,b,this._options);else if(window.web3)e.log("found global web3, will capture from it"),this._stopWeb3Recording=R(window.web3,b,this._options);return this._stopWeb3Recording?!0:!1},updateUser:function(a,b,c){this._executeRequest(z+"api.moesif.net/v1/users",a,{applicationId:b},c)},identifyUser:function(a,
b){this._userId=a;if(!this._options||!this._options.applicationId)throw Error("Init needs to be called with a valid application Id before calling identify User.");var c={user_id:a};b&&(c.metadata=b);if(this._session)c.session_token=this._session;if(this._campaign)c.campaign=this._campaign;if(this._companyId)c.company_id=this._companyId;this.updateUser(c,this._options.applicationId,this._options.callback);try{localStorage.setItem("moesif_stored_user_id",a)}catch(g){e.error("error saving to local storage")}},
updateCompany:function(a,b,c){this._executeRequest(z+"api.moesif.netundefined",a,{applicationId:b},c)},identifyCompany:function(a,b,c){this._companyId=a;if(!this._options||!this._options.applicationId)throw Error("Init needs to be called with a valid application Id before calling identify User.");var g={company_id:a};c&&(g.company_domain=c);b&&(g.metadata=b);if(this._session)g.session_token=this._session;if(this._campaign)g.campaign=this._campaign;this.updateCompany(g,this._options.applicationId,
this._options.callback);try{localStorage.setItem("moesif_stored_company_id",a)}catch(i){e.error("error saving to local storage")}},identifySession:function(a){this._session=a;localStorage.setItem("moesif_stored_session_id",a)},track:function(a,b){if(!a)throw Error("track name must have action Name defined");var c={action_name:a};if(this._companyId)c.company_id=this._companyId;if(this._userId)c.user_id=this._userId;if(this._session)c.session_token=this._session;c.request={uri:document.location.href,
verb:"GET",user_agent_string:navigator.userAgent};b&&(c.metadata=b);return this._sendOrBatch(c,this._options.applicationId,z+"api.moesif.net/v1/actions",this.requestBatchers.events,this._options.callback)},recordEvent:function(a){if(T(a))e.log("skipped logging for requests to moesif");else{e.log("determining if should log: "+a.request.uri);var b=Object.assign({},a);this._getUserId()&&(b.user_id=this._getUserId());this._getCompanyId()&&(b.company_id=this._getCompanyId());this._getSession()&&(b.session_token=
this._getSession());b.tags=this._options.getTags(a)||"";if(this._options.apiVersion)b.request.api_version=this._options.apiVersion;this._options.maskContent&&(b=this._options.maskContent(b));if(this._options.getMetadata)if(b.metadata){var c=this._options.getMetadata(b);b.metadata=Object.assign(b.metadata,c)}else b.metadata=this._options.getMetadata(b);!this._options.skip(a)&&!T(a)?this._sendOrBatch(b,this._options.applicationId,z+"api.moesif.net/v1/events",this.requestBatchers.events,this._options.callback):
e.log("skipped logging for "+a.request.uri)}},_getUserId:function(){return this._userId},_getCompanyId:function(){return this._companyId},_getSession:function(){return this._session},stop:function(){if(this._stopRecording)this._stopRecording(),this._stopRecording=null;if(this._stopWeb3Recording)this._stopWeb3Recording(),this._stopWeb3Recording=null;if(this._stopFetchRecording)this._stopFetchRecording(),this._stopFetchRecording=null}}}()})();
})();
